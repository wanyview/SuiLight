<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ¥è¯†æ²™é¾™ ğŸ§  - SuiLight çŸ¥è¯†æ²™é¾™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        .card { transition: all 0.3s; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
        .gradient-bg { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- å¯¼èˆªæ  -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <a href-2xl">ğŸ§ ="/" class="text</a>
                <span class="font-bold text-xl text-gray-800">SuiLight çŸ¥è¯†æ²™é¾™</span>
            </div>
            <div class="flex gap-4 text-sm">
                <a href="/" class="text-gray-600 hover:text-indigo-600">ğŸ  é¦–é¡µ</a>
                <a href="/?tab=agents" class="text-gray-600 hover:text-indigo-600">ğŸ¤– æ€æƒ³å®¶</a>
                <span class="text-indigo-600 font-bold">ğŸ§  çŸ¥è¯†æ²™é¾™</span>
                <a href="/?tab=capsules" class="text-gray-600 hover:text-indigo-600">ğŸ“¦ èƒ¶å›Š</a>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="max-w-6xl mx-auto px-4 py-8">
        
        <!-- æ ‡é¢˜åŒº -->
        <div class="text-center mb-12">
            <div class="text-6xl mb-4">ğŸ§ </div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2">çŸ¥è¯†æ²™é¾™</h1>
            <p class="text-xl text-gray-500">å¤šå…ƒæ€æƒ³ç¢°æ’ Â· çŸ¥è¯†èƒ¶å›Šäº§å‡º Â· æ™ºæ…§æ¶Œç°</p>
        </div>

        <!-- çŸ¥è¯†æ²™é¾™ä»‹ç» -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                <span>ğŸ’¡</span> ä»€ä¹ˆæ˜¯çŸ¥è¯†æ²™é¾™ï¼Ÿ
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center p-6 bg-indigo-50 rounded-xl">
                    <div class="text-4xl mb-3">ğŸ¤–</div>
                    <h3 class="font-bold text-lg mb-2">100ä½æ€æƒ³å®¶</h3>
                    <p class="text-gray-600 text-sm">é‚€è¯·å†å²ä¼Ÿå¤§æ€æƒ³å®¶å‚ä¸è®¨è®ºï¼Œæä¾›å¤šå…ƒè§†è§’</p>
                </div>
                <div class="text-center p-6 bg-purple-50 rounded-xl">
                    <div class="text-4xl mb-3">ğŸ’¬</div>
                    <h3 class="font-bold text-lg mb-2">å¤šè½®è®¨è®º</h3>
                    <p class="text-gray-600 text-sm">å›´ç»•è¯é¢˜æ·±å…¥æ¢è®¨ï¼Œè§‚ç‚¹ç¢°æ’äº§ç”Ÿæ™ºæ…§</p>
                </div>
                <div class="text-center p-6 bg-pink-50 rounded-xl">
                    <div class="text-4xl mb-3">ğŸ“¦</div>
                    <h3 class="font-bold text-lg mb-2">çŸ¥è¯†èƒ¶å›Š</h3>
                    <p class="text-gray-600 text-sm">å‡ç»ƒè®¨è®ºç²¾åï¼Œäº§å‡ºå¯å¤ç”¨çš„çŸ¥è¯†æˆæœ</p>
                </div>
            </div>
        </div>

        <!-- å‘èµ·è®¨è®º -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                <span>ğŸš€</span> å‘èµ·çŸ¥è¯†æ²™é¾™
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 font-bold mb-2">è®¨è®ºè¯é¢˜</label>
                    <input type="text" id="salon-topic" placeholder="ä¾‹å¦‚ï¼šAI æ˜¯å¦åº”è¯¥æ‹¥æœ‰è‡ªæˆ‘æ„è¯†ï¼Ÿ" 
                        class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none">
                </div>
                <div>
                    <label class="block text-gray-700 font-bold mb-2">é€‰æ‹©æ€æƒ³å®¶</label>
                    <select id="salon-agents" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-indigo-500 outline-none">
                        <option value="auto">ğŸ² è‡ªåŠ¨é€‰æ‹© 5 ä½</option>
                        <option value="physics">ğŸ”¬ ç‰©ç†å­¦å®¶ (ç‰›é¡¿ã€çˆ±å› æ–¯å¦)</option>
                        <option value="philosophy">ğŸ¤” å“²å­¦å®¶ (å­”å­ã€è‹æ ¼æ‹‰åº•)</option>
                        <option value="ai">ğŸ¤– AI ä¸“å®¶ (å›¾çµ)</option>
                    </select>
                </div>
            </div>
            <div class="mt-6">
                <label class="block text-gray-700 font-bold mb-2">é—®é¢˜æè¿°</label>
                <textarea id="salon-desc" placeholder="è¯¦ç»†æè¿°è®¨è®ºçš„é—®é¢˜èƒŒæ™¯..." 
                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-indigo-500 outline-none" rows="3"></textarea>
            </div>
            <div class="mt-6 flex gap-4">
                <button onclick="createSalon()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-full font-bold transition-all shadow-lg hover:shadow-xl">
                    ğŸ¯ å¯åŠ¨çŸ¥è¯†æ²™é¾™
                </button>
                <button onclick="generateTopic()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-full font-bold transition-all">
                    ğŸ² éšæœºè¯é¢˜
                </button>
            </div>
        </div>

        <!-- çµæ„Ÿå¡ç‰‡ -->
        <div class="bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 rounded-2xl shadow-xl p-8 mb-8 text-white">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span>ğŸ’¡</span> è®¨è®ºçµæ„Ÿ
            </h2>
            <div id="inspiration-container" class="text-center py-4">
                <div class="animate-pulse">åŠ è½½çµæ„Ÿ...</div>
            </div>
            <div class="flex justify-center gap-4 mt-6">
                <button onclick="getNewInspiration()" class="bg-white/20 hover:bg-white/30 px-6 py-2 rounded-full font-bold transition-all">
                    ğŸ”„ æ¢ä¸€ä¸ª
                </button>
                <button onclick="useInspiration()" class="bg-white text-orange-500 px-6 py-2 rounded-full font-bold transition-all">
                    ğŸ“ ç”¨è¿™ä¸ªè¯é¢˜
                </button>
            </div>
        </div>

        <!-- å·²æœ‰è®¨è®º -->
        <div class="bg-white rounded-2xl shadow-xl p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                    <span>ğŸ“‹</span> æ­£åœ¨è¿›è¡Œ
                </h2>
                <span id="salon-count" class="bg-indigo-100 text-indigo-600 px-3 py-1 rounded-full text-sm font-bold">0 ä¸ªæ²™é¾™</span>
            </div>
            <div id="salons-list" class="space-y-4">
                <div class="text-center py-12 text-gray-400">
                    <div class="text-4xl mb-4">ğŸ§ </div>
                    <p>æš‚æ— çŸ¥è¯†æ²™é¾™ï¼Œæ¥å‘èµ·ä¸€ä¸ªå§ï¼</p>
                </div>
            </div>
        </div>

    </main>

    <script>
        const API_BASE = window.location.origin;
        let currentInspiration = null;

        document.addEventListener('DOMContentLoaded', () => {
            loadInspiration();
            loadSalons();
        });

        // åŠ è½½çµæ„Ÿå¡ç‰‡
        async function loadInspiration() {
            try {
                const resp = await fetch(`${API_BASE}/api/coffee/inspiration`);
                const data = await resp.json();
                
                const container = document.getElementById('inspiration-container');
                
                if (data.data) {
                    currentInspiration = data.data;
                    container.innerHTML = `
                        <p class="text-2xl font-medium leading-relaxed">"${data.data.content}"</p>
                    `;
                } else {
                    container.innerHTML = '<p class="text-gray-300">æš‚æ— çµæ„Ÿ</p>';
                }
            } catch (e) {
                console.error('åŠ è½½çµæ„Ÿå¤±è´¥:', e);
            }
        }

        async function getNewInspiration() {
            await loadInspiration();
        }

        async function useInspiration() {
            if (currentInspiration) {
                document.getElementById('salon-topic').value = currentInspiration.content;
            }
        }

        // éšæœºè¯é¢˜
        async function generateTopic() {
            await loadInspiration();
            if (currentInspiration) {
                document.getElementById('salon-topic').value = currentInspiration.content;
            }
        }

        // å‘èµ·çŸ¥è¯†æ²™é¾™
        async function createSalon() {
            const topic = document.getElementById('salon-topic').value.trim();
            const desc = document.getElementById('salon-desc').value.trim();
            const agentMode = document.getElementById('salon-agents').value;
            
            if (!topic || topic.length < 5) {
                alert('è¯·è¾“å…¥è®¨è®ºè¯é¢˜ï¼ˆè‡³å°‘5ä¸ªå­—ç¬¦ï¼‰');
                return;
            }
            
            alert('ğŸ¯ çŸ¥è¯†æ²™é¾™å·²å¯åŠ¨ï¼\n\næ€æƒ³å®¶ä»¬æ­£åœ¨å‡†å¤‡è®¨è®º...\nè®¨è®ºå®Œæˆåå°†è‡ªåŠ¨ç”ŸæˆçŸ¥è¯†èƒ¶å›Šã€‚');
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('salon-topic').value = '';
            document.getElementById('salon-desc').value = '';
            
            await loadSalons();
        }

        // åŠ è½½è®¨è®ºåˆ—è¡¨
        async function loadSalons() {
            const container = document.getElementById('salons-list');
            const countBadge = document.getElementById('salon-count');
            
            // æ¨¡æ‹Ÿè®¨è®ºæ•°æ®
            const mockSalons = [
                {
                    id: '1',
                    title: 'AI æ˜¯å¦åº”è¯¥æ‹¥æœ‰è‡ªæˆ‘æ„è¯†ï¼Ÿ',
                    status: 'running',
                    agent_count: 5,
                    created_at: new Date(Date.now() - 3600000).toISOString()
                }
            ];
            
            countBadge.textContent = `${mockSalons.length} ä¸ªæ²™é¾™`;
            
            container.innerHTML = mockSalons.map(salon => `
                <div class="card bg-gray-50 rounded-xl p-6">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-bold text-lg text-gray-800 mb-2">${salon.title}</h4>
                            <div class="flex gap-4 text-sm text-gray-500">
                                <span>ğŸ¤– ${salon.agent_count} ä½æ€æƒ³å®¶</span>
                                <span>ğŸ’¬ è®¨è®ºä¸­</span>
                                <span>${formatTime(salon.created_at)}</span>
                            </div>
                        </div>
                        <span class="bg-green-100 text-green-600 px-3 py-1 rounded-full text-sm font-bold">è¿›è¡Œä¸­</span>
                    </div>
                    <div class="mt-4 flex gap-3">
                        <button onclick="joinSalon('${salon.id}')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-all">
                            ğŸ‘€ å›´è§‚è®¨è®º
                        </button>
                        <button onclick="generateCapsule('${salon.id}')" class="bg-pink-600 hover:bg-pink-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-all">
                            ğŸ“¦ ç”Ÿæˆèƒ¶å›Š
                        </button>
                    </div>
                </div>
            `).join('');
        }

        async function joinSalon(salonId) {
            alert('ğŸ‘€ è¿›å…¥è®¨è®ºè¯¦æƒ…é¡µ...');
        }

        async function generateCapsule(salonId) {
            alert('ğŸ“¦ æ­£åœ¨ç”ŸæˆçŸ¥è¯†èƒ¶å›Š...\n\nèƒ¶å›Šå°†åŒ…å«ï¼š\nâ€¢ æ ¸å¿ƒæ´è§\nâ€¢ æ”¯æ’‘è¯æ®\nâ€¢ è¡ŒåŠ¨å»ºè®®\nâ€¢ DATM è¯„åˆ†');
        }

        function formatTime(isoString) {
            const date = new Date(isoString);
            const now = new Date();
            const diff = (now - date) / 1000;
            
            if (diff < 60) return 'åˆšåˆšå¼€å§‹';
            if (diff < 3600) return `${Math.floor(diff / 60)}åˆ†é’Ÿå‰`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}å°æ—¶å‰`;
            return `${Math.floor(diff / 86400)}å¤©å‰`;
        }
    </script>
</body>
</html>.length < 10) {
                alert('è§‚ç‚¹å†…å®¹è‡³å°‘10ä¸ªå­—ç¬¦');
                return;
            }
            
            try {
                const resp = await fetch(`${API_BASE}/api/coffee/discussions`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        topic_id: currentTopicId,
                        content,
                        stance
                    })
                });
                const data = await resp.json();
                
                if (data.success) {
                    document.getElementById('new-opinion').value = '';
                    openTopicDetail(currentTopicId);
                    loadTopics();
                }
            } catch (e) {
                console.error('å‘å¸ƒå¤±è´¥:', e);
            }
        }

        // åŠ è½½çƒ­é—¨è¯é¢˜
        async function loadHotTopics() {
            try {
                const resp = await fetch(`${API_BASE}/api/coffee/topics?limit=5`);
                const data = await resp.json();
                
                const container = document.getElementById('hot-topics');
                
                if (data.data && data.data.topics.length > 0) {
                    container.innerHTML = data.data.topics.slice(0, 5).map((topic, i) => `
                        <div class="flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer" onclick="openTopicDetail('${topic.id}')">
                            <span class="text-lg font-bold text-indigo-600">${i + 1}</span>
                            <span class="text-sm text-gray-700 line-clamp-1">${topic.title}</span>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<div class="text-gray-400 text-sm">æš‚æ— è¯é¢˜</div>';
                }
            } catch (e) {
                console.error('åŠ è½½çƒ­é—¨è¯é¢˜å¤±è´¥:', e);
            }
        }

        // åŠ è½½ç»Ÿè®¡
        async function loadStats() {
            try {
                const resp = await fetch(`${API_BASE}/api/coffee/stats`);
                const data = await resp.json();
                
                if (data.data) {
                    document.getElementById('stat-topics').textContent = data.data.topic_count || 0;
                    document.getElementById('stat-discussions').textContent = data.data.opinion_count || 0;
                }
            } catch (e) {
                console.error('åŠ è½½ç»Ÿè®¡å¤±è´¥:', e);
            }
        }

        // å·¥å…·å‡½æ•°
        function getCategoryEmoji(category) {
            const emojis = {
                'ai': 'ğŸ¤–',
                'learning': 'ğŸ“š',
                'society': 'ğŸŒ',
                'philosophy': 'ğŸ¤”',
                'general': 'ğŸ’¬'
            };
            return emojis[category] || 'ğŸ’¬';
        }

        function getStanceEmoji(stance) {
            const emojis = {
                'positive': 'ğŸ‘',
                'neutral': 'ğŸ˜',
                'negative': 'ğŸ‘'
            };
            return emojis[stance] || 'ğŸ˜';
        }

        function formatTime(isoString) {
            if (!isoString) return '';
            const date = new Date(isoString);
            const now = new Date();
            const diff = (now - date) / 1000;
            
            if (diff < 60) return 'åˆšåˆš';
            if (diff < 3600) return `${Math.floor(diff / 60)}åˆ†é’Ÿå‰`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}å°æ—¶å‰`;
            return `${Math.floor(diff / 86400)}å¤©å‰`;
        }
    </script>
</body>
</html>
